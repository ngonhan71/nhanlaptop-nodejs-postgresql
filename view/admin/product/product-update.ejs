    <%- include('../header') %>
    
    <div class="content-wrapper">
        <div class="row">
            <div class="col-xl-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">Chỉnh sửa sản phẩm</h5>
                        </p>
                    </div>
                    <div class="card-body">
                        <form action="" method="POST" id="form-update"> 
                            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                            <div class="row">
                                <div class="col-xl-3">
                                    <label for="" class="form-label">Loại sản phẩm</label>
                                    <input readonly id="product-type" required type="text" class="form-control" value="<%= dataProductType['name'] %>">
                                    <input name="productType" required type="hidden" class="form-control" value="<%= dataProductType['id'] %>">
                                </div>
                                <div class="col-xl-3">
                                    <label for="" class="form-label">Danh mục</label>
                                    <select name="category" class="form-select" id="select-category">
                                        <% if (dataCategory) { %>
                                            <%  dataCategory.forEach((item) => { %>
                                            <%   if (item['id'] == dataProductInfo['category_id']) { %>
                                                    <option selected value="<%= item['id'] %>"><%= item['name'] %></option>
                                            <%    } else { %> 
                                                <option value="<%= item['id'] %>"><%= item['name'] %></option>
                                                <% } %>
                                            <%  }) %>
    
                                        <% } %> 
                                    </select>
                                </div>
                                <div class="col-xl-3">
                                    <label for="" class="form-label">Hãng</label>
                                    <select name="brand" class="form-select" id="select-brand">
                                        <% if (dataBrand) { %>
                                            <%  dataBrand.forEach((item) => { %>
                                            <%   if (item['id'] == dataProductInfo['brand']) { %>
                                                    <option selected value="<%= item['id'] %>"><%= item['name'] %></option>
                                            <%    } else { %> 
                                                <option value="<%= item['id'] %>"><%= item['name'] %></option>
                                                <% } %>
                                            <%  }) %>
    
                                        <% } %> 
                                    </select>
                                </div>
                                
                                <div class="col-xl-3">
                                    <label for="" class="form-label">Mã sản phẩm</label>
                                    <input readonly id="product-id" name="productId" required type="text" class="form-control" value="<%= dataProductInfo['product_id'] %>">
                                </div>
                                <div class="col-xl-3">
                                    <label for="" class="form-label">Tên sản phẩm</label>
                                    <input name="productName" id="product-name" required type="text" class="form-control" value="<%= dataProductInfo['name'] %>">
                                </div>
                                <div class="col-xl-3">
                                    <label for="" class="form-label">Đường dẫn</label>
                                    <input name="productSlug" id="product-slug" required type="text" class="form-control" value="<%= dataProductInfo['slug'] %>">
                                </div>
                                <div class="col-xl-3">
                                    <label for="" class="form-label">Giá sản phẩm</label>
                                    <input name="productPrice" required type="text" class="form-control" value="<%= dataProductInfo['price'] %>">
                                </div>
                                <div class="col-xl-3">
                                    <label for="" class="form-label">Khuyễn mãi</label>
                                    <input name="productDiscount" required type="text" class="form-control" value="<%= dataProductInfo['discount'] %>">
                                </div>
                                <div class="col-xl-3">
                                    <label label for="" class="form-label">Tình trạng</label>
                                    <select name="productStatus" class="form-select">
                                    <option selected value="1">Còn hàng</option>
                                    <option value="0">Hết hàng</option>
                                    </select>
                                </div>
                            </div>

                            <% if (dataProductType['id'] == 1) { %>

                                <div class="row laptop box-product-info active">
                                    <div class="col-xl-3">
                                        <label for="" class="form-label">CPU</label>
                                        <input name="productCpu" type="text" class="form-control" value="<%= dataProductInfo['cpu'] %>">
                                    </div>
                                    <div class="col-xl-3">
                                        <label for="" class="form-label">Thông tin chi tiết CPU</label>
                                        <input name="productCpuDetail" type="text" class="form-control" value="<%= dataProductInfo['cpu_detail'] %>">
                                    </div>
                                    <div class="col-xl-3">
                                        <label for="" class="form-label">Ổ cứng</label>
                                        <input name="productHardDrive" type="text" class="form-control" value="<%= dataProductInfo['hard_drive_size'] %>">
                                    </div>
                                    <div class="col-xl-3">
                                        <label for="" class="form-label">Thông tin ổ cứng</label>
                                        <input name="productHardDriveDetail" type="text" class="form-control" value="<%= dataProductInfo['hard_drive_desc'] %>">
                                    </div>
                                        <div class="col-xl-3">
                                        <label for="" class="form-label">RAM</label>
                                        <input name="productRam" type="number" step="1" min="1" class="form-control" value="<%= dataProductInfo['ram'] %>">
                                    </div>
                                        <div class="col-xl-3">
                                        <label for="" class="form-label">Card màn hình</label>
                                        <input name="productGraphics" type="text" class="form-control" value="<%= dataProductInfo['graphics'] %>">
                                    </div>
                                        <div class="col-xl-3">
                                        <label for="" class="form-label">Màn hình</label>
                                        <input name="productScreen" type="text" class="form-control" value="<%= dataProductInfo['screen'] %>">
                                    </div>
                                    <div class="col-xl-3">
                                        <label for="" class="form-label">Trọng lượng</label>
                                        <input name="productWeight" type="number" step="0.01" min="1" class="form-control" value="<%= dataProductInfo['weight'] %>">
                                    </div>
                                </div>

                            <% } %> 

                            <% if (dataProductType['id'] == 2) { %>

                                <div class="row other box-product-info active">
                                    <div class="col-xl-12">
                                        <label for="" class="form-label">Thông tin</label>
                                        <input name="info" type="text" class="form-control" value="<%= dataProductInfo['info'] %> ">
                                    </div>
                                    <div class="col-xl-12">
                                        <label for="" class="form-label">Mô tả</label>
                                        <textarea name="description" id="ckeditor-accessories-description" class="form-control">
                                            <%= dataProductInfo['description'] %> 
                                        </textarea>
                                    </div>
                                    
                                </div>
                                
                             <% } %>   
                            
                            <div class="row mt-2 p-2">
                            </div>
                            <button type="submit" name="submit-update-product" class="btn btn-danger mt-3">Lưu</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

<!-- Close admin-wrapper -->
<script src="https://cdn.ckeditor.com/ckeditor5/33.0.0/classic/ckeditor.js"></script>
<script>
    
    ClassicEditor
        .create( document.querySelector('#ckeditor-accessories-description'))
        .catch( error => {
            console.error( error );
    } )
</script>
</div>

    <script type="module">
        import { toSlug, removeDuplicateSpaceAndTrim } from '/js/validate.js'

        const productNameElement = document.querySelector('#form-update input[name="productName"]')
        const productSlugElement = document.querySelector('#form-update input[name="productSlug"]')
        const inputElements = document.querySelectorAll('#form-update input[type="text"]')



        inputElements.forEach((input) => {
            input.addEventListener('blur', function() {
                let inputValue = removeDuplicateSpaceAndTrim(this.value)
                this.value = inputValue
            })
        })

        productNameElement.addEventListener('blur',function() {
            productSlugElement.value = toSlug(productNameElement.value)
        })


    </script>

</body>
</html>