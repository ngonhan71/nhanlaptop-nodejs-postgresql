<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head.ejs') %>
    <link rel="stylesheet" href="css/banner.css">
    <link rel="stylesheet" href="css/homepage-product.css">
</head>
<body>

    <%- include('../partials/header') %>

    <div class="main">
        <div class="home-banner">
            <div class="container">
                <div class="row">
                    <div class="col col-xl-9">
                        <div class="row">
                            <div class="col col-xl-12">
                                <div class="slider">
                                    <div class="dots">
                                        <ul>
                                            <li class="dot"></li>
                                            <li class="dot"></li>
                                            <li class="dot"></li>
                                            <li class="dot"></li>
                                            <li class="dot"></li>
                                        </ul>
                                    </div>
                                <div class="slide-item">
                                        <img src="https://theme.hstatic.net/1000026716/1000440777/14/slideshow_14.jpg?v=23296" alt="">
                                </div>
                                <div class="slide-item">
                                        <img src="https://theme.hstatic.net/1000026716/1000440777/14/slideshow_3.jpg?v=23296" alt="">
                                </div>
                                <div class="slide-item">
                                        <img src="https://theme.hstatic.net/1000026716/1000440777/14/slideshow_11.jpg?v=23296" alt="">
                                </div>
                                <div class="slide-item">
                                        <img src="https://theme.hstatic.net/1000026716/1000440777/14/slideshow_12.jpg?v=23307" alt="">
                                </div>
                                <div class="slide-item">
                                        <img src="https://hanoicomputercdn.com/media/banner/01_Decc6ef5979b85c2db3ba8c211780c60c9f.jpg" alt="">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    <div class="col col-xl-3" style="margin: auto 0;">
                        <div class="banner-right">
                            <img src="https://theme.hstatic.net/1000026716/1000440777/14/solid1.jpg?v=23296" alt="">
                            <img src="https://theme.hstatic.net/1000026716/1000440777/14/solid2.jpg?v=23296" alt="">
                            <img src="https://theme.hstatic.net/1000026716/1000440777/14/solid3.jpg?v=23296" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="homepage-product homepage-laptop">
            <div class="container">
                <div class="homepage-product__header" style="margin-bottom: 20px;">
                    <div class="row">
                        <h2 class="header-title">Laptop, máy tính xách tay</h2>
                        <ul class="header-sub-category">
                            <li><a href="">Laptop Dell</a></li>
                            <div class="homepage-product-separator"></div>
                            <li><a href="">Laptop HP</a></li>
                            <div class="homepage-product-separator"></div>
                            <li><a href="">Laptop Lenovo</a></li>
                            <div class="homepage-product-separator"></div>
                            <li><a href="">Laptop MSI</a></li>
                        </ul>
                        <div class="show-all">
                            <a href="">Xem tất cả</a>
                        </div>
                    </div>
                </div>
                <div class="homepage-product__body">
                    <div class="row">
                        <% data.forEach((item) => { %>
                            <div class="col col-xl-2-4 col-sm-6 col-6">
                                <div class="product-item">
                        <% if (item['discount'] != 0) { %>
                            <div class="box-discount">
                                <p><%= item['discount'] %>%</p>
                            </div>
                        <% } %> 
                                    <a href="/san-pham/laptop-may-tinh-xach-tay/<%=item['slug']%>" data-id="<%=item['product_id']%>" class="product-img">
                                        <img src="<%=item['thumbnail']%>" alt="">
                                    </a>
                                    <div class="product-info">
                                        <a href="/san-pham/laptop-may-tinh-xach-tay/<%=item['slug']%>">
                                            <h3 class="product-name">
                                                <%=`LAPTOP ${item['name']} (${item['cpu']}/${item['ram']}GB RAM/${item['hard_drive_size']}/${item['screen']})`%>
                                            </h3>
                                        </a>
                        <% if (item['discount'] != 0) { %>
                        <%    let priceDiscount = item['price'] - item['price']* (item['discount'])/100 %>
                        <%    priceDiscount = helper.roundAndFormatPrice(priceDiscount) %>
                      
                                        <div class="discount-info">
                                            <span class="old-price"><%=`${helper.formatPrice(item['price'])}đ`%></span>
                                            <span class="discount">( Tiết kiệm: <%=item['discount']%>% )</span>
                                        </div>
                                        
                                        <p class="price"><%=`${priceDiscount}đ`%></p>
                        <% } else { %>

                                        <div class="discount-info">
                                            <span class="old-price" style="visibility: hidden;"><%=`${helper.formatPrice(item['price'])}đ`%></span>
                                            <span class="discount"></span>
                                        </div>
                                        
                                        <p class="price"><%=`${helper.formatPrice(item['price'])}đ`%></p>
                        <% } %>
                        <% if (item['status'] == 1) { %> 
                                        <div class="action">
                                            <p class="available"><i class="fa fa-check"></i> Còn hàng</p>
                                            <p class="cart" data-discount="<%=item['discount']%>" 
                                                data-price="<%=item['price']%>" data-name="<%=item['name']%>" 
                                                data-id="<%=item['product_id']%>" data-img="<%=item['thumbnail']%>"
                                                data-info="<%=`${item['cpu']}/${item['ram']}GB RAM/${item['hard_drive_size']}`%>"
                                                data-slug="<%=item['slug']%>">
                                                <i class="bi bi-cart3"></i>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>         
                            <% } else { %>
                                        <div class="action">
                                            <p class="sold-out"><i class="bi bi-telephone-fill"></i> Liên hệ</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <% } %>
                        <% }) %>
                    </div>
                </div>
            </div>
        </div>
     </div>
        <!-- close div main -->

    <%- include('../partials/footer') %>
    <script src="/js/homepageSlider.js"></script>

    <script type="module">
        import { CCart } from '/js/cart.js';
        let cart =  new CCart

        const btnAddToCart = document.querySelectorAll('.product-item .action .cart')

        btnAddToCart.forEach((btn) => {
            btn.addEventListener('click', function(e) {
                const productId = this.getAttribute('data-id')
                const productName = this.getAttribute('data-name')
                const productInfo = this.getAttribute('data-info')
                const productThumbnail = this.getAttribute('data-img')
                const productSlug = this.getAttribute('data-slug')
                let productPrice = parseInt(this.getAttribute('data-price'))
                const productDiscount = parseInt(this.getAttribute('data-discount'))

                if (productDiscount != 0) {
                    productPrice = productPrice - productPrice * (productDiscount)/100
                    productPrice = Math.round(productPrice/10000)*10000

                }
                cart.addToCart({
                    productId,
                    quantity: 1,
                    productName,
                    productInfo,
                    productThumbnail,
                    productPrice,
                    productSlug
                })

                countProductOfCart.forEach((element) => {
                    element.innerText = cart.getCountProduct()
                })

                showToast({
                    type: 'success',
                    title: 'Thêm thành công',
                    desc: 'Sản phẩm đã được thêm vào giỏ hàng!',
                    duration: 1500
                })

            })
        })

    </script>
    
</body>
</html>

